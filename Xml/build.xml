<?xml version="1.0" encoding="UTF-8"?>
<project name="TestJenkins" default="build" basedir="../.">
	<property name="phpunit" location="C:/bin/phpunit" />

	<target name="build" description="Tâche principale d'intégration continue"
		depends="clean, phpunit" />

	<target name="clean" description="Supprime et recrée les répertoires">
		<delete dir="${basedir}/build/api" />
		<delete dir="${basedir}/build/coverage" />
		<delete dir="${basedir}/build/logs" />

		<mkdir dir="${basedir}/build/api" />
		<mkdir dir="${basedir}/build/coverage" />
		<mkdir dir="${basedir}/build/logs" />
	</target>

	<target name="phpunit"
	        unless="phpunit.done"
	        depends="clean"
	        description="Run unit tests with PHPUnit">
	 <exec executable="${phpunit}" resultproperty="result.phpunit" taskname="phpunit">
	  <arg path="${basedir}/Xml/phpunit.xml"/>
	 </exec>

	 <property name="phpunit.done" value="true"/>
	</target>
		
</project>